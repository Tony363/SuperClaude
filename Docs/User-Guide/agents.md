# Agent System Overview

SuperClaude routes work to a collection of core Python agents and extended
Markdown personas. Understanding how they load helps you tailor commands and
write effective specs.

## 1. Agent Categories

- **Core agents** (`SuperClaude/Agents/core/`) implement strategist behaviour in
  Python. They handle tasks such as implementation, quality review, technical
  writing, and security analysis.
- **Extended personas** (`SuperClaude/Agents/Extended/`) are Markdown playbooks
  grouped by domain. Each playbook decodes into a lightweight runtime wrapper
  when first requested.

The loader uses keyword matching, capability tiers, and recent usage telemetry
to select the best candidate for each command.

## 2. Loading Flow

1. `AgentLoader` and `ExtendedAgentLoader` build candidate lists based on the
   command arguments and declared focus areas.
2. Personas are filtered by availability, requested language/framework, and
   compatibility with behavioural flags (e.g., `--fast-codex`).
3. Selected agents receive the command context, current worktree snapshot, and
   any declarative plan generated by previous steps.
4. Results flow back into the command executor for consensus and quality
   grading.

## 3. Customising Selection

- Use `--delegate <agent-name>` to pin a specific agent when experimenting.
- Supply `--loop` to allow multi-agent hand-off when a single persona is not
  sufficient.
- Provide explicit language hints via `--language python` or include the target
  stack in the command description so the loader can prioritise relevant
  personas.

## 4. Telemetry & Reporting

- Agent invocations append entries to `.superclaude_metrics/agent_usage.json`.
- Run `python scripts/report_agent_usage.py` to generate a Markdown summary of
  agent activity and dormant personas.

## 5. Adding New Agents

1. Create a new Markdown persona under the appropriate category in
   `SuperClaude/Agents/Extended/XX-â€¦`.
2. Include YAML front matter specifying `triggers`, `tools`, and `focus_areas`.
3. For strategist-level behaviour, implement a Python subclass that extends
   `HeuristicMarkdownAgent`, register it in the agent registry, and document the
   addition in `.codex-os/product/decisions.md`.

Agents are the primary way to encode specialised reasoning. Keeping their
playbooks up to date ensures commands stay targeted and opinionated.
